# 训练设置

YOLO 模型的训练设置包括在训练过程中使用的各种超参数和配置。这些设置会影响模型的性能、速度和准确性。关键的训练设置包括批量大小、学习率、动量和权重衰减。此外，优化器、损失函数和训练数据集的选择也会影响训练过程。仔细调整和实验这些设置对于优化性能至关重要。

| 参数        | 默认值  | 描述 |
|-------------|---------|------|
| model       | None    | 指定用于训练的模型文件。接受 .pt 预训练模型或 .yaml 配置文件的路径。对于定义模型结构或初始化权重是必需的。 |
| data        | None    | 数据集配置文件的路径（例如 coco8.yaml）。该文件包含数据集特定的参数，包括训练和验证数据的路径、类名和类数。 |
| epochs      | 100     | 总训练周期数。每个周期代表对整个数据集的一次完整遍历。调整此值可以影响训练时长和模型性能。 |
| time        | None    | 最大训练时间（小时）。如果设置，此参数将覆盖 epochs 参数，允许在指定时间后自动停止训练。适用于时间受限的训练场景。 |
| patience    | 100     | 在验证指标没有改善的情况下等待的周期数，然后提前停止训练。通过在性能停滞时停止训练来防止过拟合。 |
| batch       | 16      | 批量大小，有三种模式：设置为整数（例如 batch=16），自动模式为 60% GPU 内存利用率（batch=-1），或指定利用率分数的自动模式（batch=0.70）。 |
| imgsz       | 640     | 训练的目标图像大小。所有图像在输入模型前都会调整为此尺寸。影响模型的准确性和计算复杂度。 |
| save        | True    | 启用训练检查点和最终模型权重的保存。对于恢复训练或模型部署很有用。 |
| save_period | -1      | 模型检查点保存频率，以周期为单位。值为 -1 时禁用此功能。适用于长时间训练期间保存中间模型。 |
| cache       | False   | 启用数据集图像的内存缓存（True/ram）、磁盘缓存（disk）或禁用缓存（False）。通过减少磁盘 I/O 提高训练速度，但会增加内存使用。 |
| device      | None    | 指定用于训练的计算设备：单个 GPU（device=0）、多个 GPU（device=0,1）、CPU（device=cpu）或 Apple silicon 的 MPS（device=mps）。 |
| workers     | 8       | 数据加载的工作线程数（每个 RANK 如果是多 GPU 训练）。影响数据预处理和输入模型的速度，特别是在多 GPU 设置中。 |
| project     | None    | 保存训练输出的项目目录名称。允许有组织地存储不同的实验。 |
| name        | None    | 训练运行的名称。用于在项目文件夹中创建子目录，保存训练日志和输出。 |
| exist_ok    | False   | 如果为 True，允许覆盖现有的项目/名称目录。适用于迭代实验，无需手动清除以前的输出。 |
| pretrained  | True    | 确定是否从预训练模型开始训练。可以是布尔值或特定模型的路径，从中加载权重。提高训练效率和模型性能。 |
| optimizer   | 'auto'  | 训练的优化器选择。选项包括 SGD、Adam、AdamW、NAdam、RAdam、RMSProp 等，或根据模型配置自动选择。影响收敛速度和稳定性。 |
| verbose     | False   | 启用训练期间的详细输出，提供详细的日志和进度更新。适用于调试和密切监控训练过程。 |
| seed        | 0       | 设置训练的随机种子，确保相同配置下结果的可重复性。 |
| deterministic | True  | 强制使用确定性算法，确保可重复性，但可能由于限制非确定性算法而影响性能和速度。 |
| single_cls  | False   | 在多类数据集中将所有类视为单一类进行训练。适用于二分类任务或关注对象存在而非分类时。 |
| rect       | False    | 启用矩形训练，优化批次组成以最小化填充。可以提高效率和速度，但可能影响模型准确性。 |
| cos_lr     | False    | 使用余弦学习率调度器，根据余弦曲线调整学习率。帮助更好地管理学习率以提高收敛性。 |
| close_mosaic | 10     | 在最后 N 个周期禁用马赛克数据增强，以在完成前稳定训练。设置为 0 禁用此功能。 |
| resume     | False    | 从最后保存的检查点恢复训练。自动加载模型权重、优化器状态和周期计数，继续无缝训练。 |
| amp        | True     | 启用自动混合精度（AMP）训练，减少内存使用并可能加速训练，对准确性影响最小。 |
| fraction   | 1.0      | 指定用于训练的数据集比例。允许在资源有限时对数据集子集进行训练，适用于实验。 |
| profile    | False    | 启用训练期间的 ONNX 和 TensorRT 速度分析，适用于优化模型部署。 |
| freeze     | None     | 冻结模型的前 N 层或按索引指定的层，减少可训练参数。适用于微调或迁移学习。 |
| lr0        | 0.01     | 初始学习率（例如 SGD=1E-2，Adam=1E-3）。调整此值对于优化过程至关重要，影响模型权重更新的速度。 |
| lrf        | 0.01     | 最终学习率作为初始率的分数 =（lr0 * lrf），与调度器结合使用以随时间调整学习率。 |
| momentum   | 0.937    | SGD 的动量因子或 Adam 优化器的 beta1，影响当前更新中包含的过去梯度。 |
| weight_decay | 0.0005 | L2 正则化项，惩罚大权重以防止过拟合。 |
| warmup_epochs | 3.0   | 学习率预热的周期数，从低值逐渐增加到初始学习率，以在早期稳定训练。 |
| warmup_momentum | 0.8 | 预热阶段的初始动量，在预热期间逐渐调整到设定的动量。 |
| warmup_bias_lr | 0.1  | 预热阶段的偏置参数学习率，帮助在初始周期稳定模型训练。 |
| box        | 7.5      | 损失函数中框损失组件的权重，影响对准确预测边界框坐标的重视程度。 |
| cls        | 0.5      | 总损失函数中分类损失的权重，影响正确类预测相对于其他组件的重要性。 |
| dfl        | 1.5      | 分布焦点损失的权重，用于某些 YOLO 版本的细粒度分类。 |
| pose       | 12.0     | 在姿态估计模型中姿态损失的权重，影响对准确预测姿态关键点的重视程度。 |
| kobj       | 2.0      | 姿态估计模型中关键点对象性损失的权重，平衡检测置信度与姿态准确性。 |
| label_smoothing | 0.0 | 应用标签平滑，将硬标签软化为目标标签和标签的均匀分布的混合，可以提高泛化能力。 |
| nbs        | 64       | 损失归一化的名义批量大小。 |
| overlap_mask | True   | 确定训练期间分割掩码是否应重叠，适用于实例分割任务。 |
| mask_ratio | 4        | 分割掩码的下采样比例，影响训练期间使用的掩码分辨率。 |
| dropout    | 0.0      | 分类任务中的正则化丢弃率，通过在训练期间随机省略单元来防止过拟合。 |
| val        | True     | 启用训练期间的验证，允许定期评估模型在单独数据集上的性能。 |
| plots      | False    | 生成并保存训练和验证指标的图表，以及预测示例，提供模型性能和学习进展的可视化见解。 |